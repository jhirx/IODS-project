---
title: "Clustering and classification"
author: "jouni hirvonen"
date: "20 11 2019"
output: html_document
### Install required packages

First, we install the required packages for the analysis: tidyr, ggplot2, GGally, gridExtra (for multiple plots)

 ```{r, results="hide", message=FALSE, warning=FALSE}
install.packages("tidyr", repos = "http://cloud.r-project.org")
install.packages("ggplot2", repos = "http://cloud.r-project.org")
install.packages("GGally", repos = "http://cloud.r-project.org")
install.packages("gridExtra", repos = "http://cloud.r-project.org")
 ```
and make the packages available

 ```{r, results="hide", message=FALSE}
library(tidyr); library(dplyr); library(ggplot2); library(gridExtra)
```


Read data from data :

```{r}
library(MASS)

# load the data
data("Boston")
str(Boston)
```
Data has  14 variables and 506 observations

Glimpse at the boston data
```{r}
glimpse(Boston) 
```

Do some pairs 
```{r}
pairs(Boston)
```

And then drawing a bar plot of each variable

```{r,  message=FALSE, warning=FALSE, fig.width=12, fig.height=10}
gather(Boston) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
```

Scaling data first take Boston data and summaraised it

```{r}
summary(Boston)
```

Then  scaling so we can compare data
```{r}
# center and standardize variables
boston_scaled <- scale(Boston)

# summaries of the scaled variables
summary(boston_scaled)

```
We can see all values has change in same scale

```{r}
# class of the boston_scaled object
class(boston_scaled)

# change the object to data frame
boston_scaled <- as.data.frame(boston_scaled)
```

Then we create a categorical variable of the crime rate in the Boston dataset (from the scaled crime rate).

```{r}
# create a quantile vector of crim and print it
bins <- quantile(boston_scaled$crim)
```

We use the quantiles as the break points in the categorical variable. 

```{r}
bins
```

Next 
```{r}
# create a categorical variable 'crime'
crime <- cut(boston_scaled$crim, breaks = bins, include.lowest = TRUE, labels = c("low", "med_low", "med_high", "high"))

# look at the table of the new factor crime
table(crime)

```

As asked, drop the old crime rate variable from the dataset. 
```{r}
boston_scaled <- dplyr::select(boston_scaled, -crim)
```

Last we divide the dataset to train and test sets, so that 80% of the data belongs to the train set.
number of rows in the Boston dataset 
```{r}
n <- nrow(boston_scaled)
```

choose randomly 80% of the rows
```{r}
ind <- sample(n,  size = n * 0.8)
```

Then we create sets Train and test
```{r}
# create train set
train <- boston_scaled[ind,]

# create test set 
test <- boston_scaled[-ind,]

# save the correct classes from test data
correct_classes <- test$crime

# remove the crime variable from test data
test <- dplyr::select(test, -crime)

```


